{% extends "base.html" %}

{% block content %}
<h1>Global Statistics for Video : {{ video.path }}</h1>

<div id="viddiv" style="float:center;margin: auto;width: 30%;padding: 10pxx;">
        <video id="vid" style="text-align:center;position: relative;left: 50%;transform: translateX(-50%);" width="300em" height="250em"
            controls>
            <source src="{{ url_for('static', filename='uploads/content_vids/') }}{{ video.path }}" type="video/mp4"> Your browser does not support the video tag.
        </video>
    </div>
{% for reaction in video.reactions %}
<p>Reaction by : user_{{ reaction.reaktor.id }}</p>
<div height="400px" width="400px" style="width:100%;height:100vh;position:relative;">
    <canvas id="myChart_{{ reaction.id }}" width="400" height="400" style="position:absolute;top:0;bottom:0;right:0;left:0;margin:auto;"></canvas>
</div>



<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
var ctx = document.getElementById('myChart_{{ reaction.id }}').getContext('2d');
ctx.canvas.width = 700;
ctx.canvas.height = 500;

var reaction_string = JSON.parse("{{ reaction.reaction_string }}");

var reaction_point_array = [];
for(var i = 0; i < reaction_string[0].length; i++) {
    var point = {
        x : reaction_string[0][i],
        y : reaction_string[1][i]
    }
    reaction_point_array.push(point);
}

var myChart = new Chart(ctx, {
    type: 'scatter',
    data: {
        datasets: [{
            label: '#',
            borderColor: 'blue',
            borderWidth: 1,
            pointBackgroundColor: ['#000', '#00bcd6', '#d300d6'],
            pointBorderColor: ['#000', '#00bcd6', '#d300d6'],
            pointRadius: 1,
            pointHoverRadius: 5,
            fill: true,
            showLine: true,
            data: reaction_point_array,
            backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)'
            ],
            borderColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)'
            ],
 
        }]
    },
    options: {
        maintainAspectRatio : false,
        responsive: false,
        scales: {
            yAxes: [{
                ticks: {
                    max : 100.0,
                    min : 0.0,
                    fixedStepSize: 0.1
                }
            }]
        }
    }
});

</script>
{% endfor %}
{% endblock %}
